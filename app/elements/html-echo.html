<link rel="import" href="../../bower_components/polymer/polymer.html">

<script>
  Polymer({

    is: 'html-echo',

    properties: {
      html: {
        type: String,
        value: ''
      },

      search:{
        type: String,
        value: ''
      }
    },

    observers: [
      'htmlChanged(html, search)'
    ],

    htmlChanged: function(html, search) {
      var self = this;
      var regExp = /<\/?[^>]+>/gi;
      var res = html.replace(/\{{(.*?)\}}/g, function(x){
        return item[x]; });
      self.innerHTML = res;
      var array = res.replace(regExp,',').split(',').filter(Boolean);
      _.forEach(array, function(n) {
        var origin = n;
        if (search) {
          n = n.replace(new RegExp('(' + search + ')', 'gi'),
            '<span class="highlighted">$1</span>');
          console.log(n);
          self.innerHTML = self.innerHTML.replace(origin,n);
        }
      });
    }

  });
</script>
